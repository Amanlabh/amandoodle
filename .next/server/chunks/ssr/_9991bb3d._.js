module.exports=[87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},45222,20005,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);a.s(["MessageCircle",()=>c],45222);let d=(0,b.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);a.s(["LogOut",()=>d],20005)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);a.s(["Users",()=>b],60246)},72079,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(78560),e=a.i(45222),f=a.i(92759),g=a.i(46842),h=a.i(20005),i=a.i(60246),j=a.i(63588);function k(){let[a,k]=(0,c.useState)(null),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!1),x=(0,c.useRef)(null),y="amanlabh4@gmail.com";(0,c.useEffect)(()=>{z()},[]),(0,c.useEffect)(()=>{a&&(C(),F())},[a]),(0,c.useEffect)(()=>{H()},[p]);let z=async()=>{try{let{data:{user:a}}=await d.supabase.auth.getUser();a&&k(a)}catch(a){console.error("Error checking auth:",a)}finally{u(!1)}},A=async()=>{w(!0);try{let a=`${window.location.origin}/chat`;console.log("Redirect URI:",a);let{error:b}=await d.supabase.auth.signInWithOAuth({provider:"google",options:{redirectTo:a}});if(b)throw b}catch(a){console.error("Error signing in with Google:",a)}finally{w(!1)}},B=async()=>{await d.supabase.auth.signOut(),k(null),m([]),o(null),q([])},C=async()=>{if(a?.email)try{let{data:b,error:c}=await d.supabase.from("chat_rooms").select("*").order("last_message_at",{ascending:!1});if(c)throw c;if(m(b||[]),b&&b.length>0)if(a.email===y);else{let c=b.find(b=>b.user_email===a.email);c?(o(c),E(c.id)):D()}else a.email!==y&&D()}catch(a){console.error("Error fetching chat rooms:",a)}},D=async()=>{if(a?.email)try{let{data:b,error:c}=await d.supabase.from("chat_rooms").insert([{user_email:a.email,user_name:a.user_metadata?.name||a.email,user_avatar_url:a.user_metadata?.avatar_url}]).select();if(c)throw c;b&&b[0]&&(o(b[0]),m(a=>[b[0],...a]))}catch(a){console.error("Error creating chat room:",a)}},E=async a=>{try{let{data:b,error:c}=await d.supabase.from("chat_messages").select("*").eq("room_id",a).order("created_at",{ascending:!0});if(c)throw c;q(b||[])}catch(a){console.error("Error fetching messages:",a)}},F=()=>{let a=d.supabase.channel("chat_rooms_changes").on("postgres_changes",{event:"*",schema:"public",table:"chat_rooms"},a=>{"INSERT"===a.eventType?m(b=>[a.new,...b]):"UPDATE"===a.eventType&&m(b=>b.map(b=>b.id===a.new.id?a.new:b))}).subscribe(),b=d.supabase.channel("chat_messages_changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages"},a=>{let b=a.new;n&&b.room_id===n.id&&q(a=>[...a,b])}).subscribe();return()=>{a.unsubscribe(),b.unsubscribe()}},G=async b=>{if(b.preventDefault(),!r.trim()||!n||!a?.email)return;let c={room_id:n.id,sender_email:a.email,sender_name:a.user_metadata?.name||a.email,message:r.trim(),is_admin:a.email===y};try{let{error:a}=await d.supabase.from("chat_messages").insert([c]);if(a)throw a;await d.supabase.from("chat_rooms").update({last_message_at:new Date().toISOString()}).eq("id",n.id),s("")}catch(a){console.error("Error sending message:",a)}},H=()=>{x.current?.scrollIntoView({behavior:"smooth"})};if(t)return(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!a)return(0,b.jsx)("div",{className:"max-w-md mx-auto",children:(0,b.jsxs)("div",{className:"text-center py-8 bg-card border border-border rounded-lg",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(e.MessageCircle,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Drop a message to me !"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"sign in to Drop me a message"})]}),(0,b.jsxs)("button",{onClick:A,disabled:v,className:"w-full px-4 py-2 bg-primary text-primary-foreground rounded-md text-sm font-medium hover:bg-primary/90 disabled:opacity-50 transition-colors flex items-center justify-center gap-2 mb-4",children:[v?(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}):(0,b.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,b.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,b.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,b.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,b.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),(0,b.jsx)("button",{onClick:()=>window.location.href="/",className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-md text-sm font-mono hover:bg-gray-200 transition-colors",children:"~/aman-kumar"})]})});let I=a?.email===y;return(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsxs)("div",{className:"flex h-[600px] border border-border rounded-lg overflow-hidden bg-card",children:[I&&(0,b.jsxs)("div",{className:"w-80 border-r border-border bg-background",children:[(0,b.jsx)("div",{className:"p-4 border-b border-border",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Conversations"}),(0,b.jsx)("button",{onClick:B,className:"p-1 text-muted-foreground hover:text-foreground transition-colors",title:"Sign out",children:(0,b.jsx)(h.LogOut,{size:16})})]})}),(0,b.jsx)("div",{className:"overflow-y-auto h-full",children:0===l.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(i.Users,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"No conversations yet"})]}):(0,b.jsx)("div",{className:"divide-y divide-border",children:l.map(a=>(0,b.jsx)("div",{onClick:()=>{o(a),E(a.id)},className:`p-4 cursor-pointer hover:bg-muted transition-colors ${n?.id===a.id?"bg-muted":""}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:(0,b.jsx)(g.User,{size:20,className:"text-primary"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h4",{className:"font-medium text-foreground truncate",children:a.user_name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:a.user_email})]})]})},a.id))})})]}),(0,b.jsx)("div",{className:"flex-1 flex flex-col",children:n?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"p-4 border-b border-border bg-background",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:(0,b.jsx)(g.User,{size:16,className:"text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:I?n.user_name:"Chat with Aman"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:I?n.user_email:"Online"})]})]}),!I&&(0,b.jsx)("button",{onClick:B,className:"p-1 text-muted-foreground hover:text-foreground transition-colors",title:"Sign out",children:(0,b.jsx)(h.LogOut,{size:16})})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===p.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(j.MessageSquare,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"No messages yet. Start the conversation!"})]}):p.map(a=>(0,b.jsx)("div",{className:`flex ${a.is_admin===I?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${a.is_admin===I?"bg-primary text-primary-foreground":"bg-muted text-foreground"}`,children:[(0,b.jsx)("p",{className:"text-sm",children:a.message}),(0,b.jsx)("p",{className:`text-xs mt-1 ${a.is_admin===I?"text-primary-foreground/70":"text-muted-foreground"}`,children:new Date(a.created_at).toLocaleTimeString()})]})},a.id)),(0,b.jsx)("div",{ref:x})]}),(0,b.jsx)("div",{className:"p-4 border-t border-border bg-background",children:(0,b.jsxs)("form",{onSubmit:G,className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:r,onChange:a=>s(a.target.value),placeholder:"Type your message...",className:"flex-1 px-3 py-2 bg-background border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-transparent"}),(0,b.jsx)("button",{type:"submit",disabled:!r.trim(),className:"p-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,b.jsx)(f.Send,{size:16})})]})})]}):(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,b.jsx)(i.Users,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"Select a conversation to start chatting"})]})})})]})})}a.s(["default",()=>k])},52763,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(78560),e=a.i(45222),f=a.i(210),g=a.i(38246),h=a.i(72079);function i(){let[a,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!0);(0,c.useEffect)(()=>{l();let{data:a}=d.supabase.auth.onAuthStateChange(async(a,b)=>{b?.user?i(b.user):i(null)});return()=>{a.subscription.unsubscribe()}},[]);let l=async()=>{try{let{data:{user:a}}=await d.supabase.auth.getUser();i(a)}catch(a){console.error("Error checking auth:",a)}finally{k(!1)}};return(0,b.jsxs)("main",{className:"relative min-h-screen bg-background overflow-x-hidden",children:[(0,b.jsxs)("div",{className:"pointer-events-none fixed inset-0 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:`
              linear-gradient(to right, var(--grid-color) 1px, transparent 1px),
              linear-gradient(to bottom, var(--grid-color) 1px, transparent 1px)
            `,backgroundSize:"60px 60px"}}),(0,b.jsx)("div",{className:"absolute inset-0",style:{background:`
              radial-gradient(ellipse at 50% 0%, transparent 0%, var(--background) 70%),
              linear-gradient(to bottom, transparent 0%, var(--background) 100%)
            `}}),(0,b.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-[60vh]",style:{background:"linear-gradient(to top, var(--background) 0%, transparent 100%)",transform:"perspective(500px) rotateX(60deg)",transformOrigin:"bottom center"},children:(0,b.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:`
                linear-gradient(to right, var(--grid-color) 1px, transparent 1px),
                linear-gradient(to bottom, var(--grid-color) 2px, transparent 2px)
              `,backgroundSize:"80px 40px"}})}),(0,b.jsx)("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:"radial-gradient(var(--grid-color) 1px, transparent 1px)",backgroundSize:"20px 20px"}})]}),(0,b.jsxs)("div",{className:"relative z-10 mx-auto max-w-6xl px-6 py-16 md:py-24",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)(g.default,{href:"/",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-6",children:[(0,b.jsx)(f.ArrowLeft,{size:16}),"Back to Home"]}),(0,b.jsx)("div",{className:"mb-6 inline-block rounded border border-border bg-card/80 backdrop-blur-sm px-3 py-1 font-mono text-sm text-muted-foreground",children:"~/chat"}),(0,b.jsx)("h1",{className:"mb-4 text-4xl font-bold tracking-tight text-foreground md:text-5xl",children:a?.email==="amanlabh4@gmail.com"?"Admin Chat":"Drop a Message"}),(0,b.jsx)("p",{className:"mb-6 font-mono text-lg text-muted-foreground",children:a?.email==="amanlabh4@gmail.com"?"Manage conversations with visitors":"Start a real-time conversation with Aman"})]}),(0,b.jsx)("div",{className:"rounded-lg border border-border bg-card/80 backdrop-blur-sm p-6",children:(0,b.jsx)(h.default,{})}),(0,b.jsxs)("div",{className:"mt-8 grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-lg border border-border bg-card/80 backdrop-blur-sm p-6",children:[(0,b.jsxs)("h3",{className:"font-semibold text-foreground mb-3 flex items-center gap-2",children:[(0,b.jsx)(e.MessageCircle,{size:20}),"Real-time Chat"]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Messages appear instantly without needing to refresh. Stay connected with real-time updates."})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-border bg-card/80 backdrop-blur-sm p-6",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground mb-3",children:"Secure Authentication"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sign in with Google to start chatting. Your conversations are private and secure."})]})]})]})]})}a.s(["default",()=>i])}];

//# sourceMappingURL=_9991bb3d._.js.map